<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ุขุฒููู โ ุญุงูุช ูพุงุณุฎูุงูู</title>
    <style>
        :root {
            --pink: #fa4779;
            --pink2: #ff7aa6;
            --pink-soft: rgba(250, 71, 121, 0.12);
            --bg: #f6f7fb;
            --card: #ffffff;
            --text: #0f172a;
            --border: #e5e7eb;
            --correct: #7fd1b9;
        }
        body.dark {
            --bg: #0b1020;
            --card: #131a33;
            --text: #e5e7eb;
            --border: #263056;
        }
        * {
            box-sizing: border-box;
        }
        body {
            margin: 0;
            font-family: 'Vazirmatn', Tahoma, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }
        .theme-toggle {
            position: fixed;
            top: 14px;
            left: 14px;
            width: 38px;
            height: 38px;
            border-radius: 12px;
            background: var(--card);
            border: 1px solid var(--border);
            cursor: pointer;
            z-index: 10;
        }
        .wrapper {
            max-width: 1200px;
            margin: 70px auto;
            display: grid;
            grid-template-columns: 1fr 420px;
            gap: 26px;
        }
        .card, .sheet {
            background: var(--card);
            border-radius: 28px;
            padding: 28px;
            box-shadow: 0 25px 55px rgba(0, 0, 0, 0.18);
        }
        .progress-wrap {
            height: 12px;
            background: linear-gradient(90deg, #eee, #ddd);
            border-radius: 999px;
            overflow: hidden;
            margin-bottom: 28px;
        }
        .progress {
            height: 100%;
            width: 0%;
            background: linear-gradient(135deg, var(--pink), var(--pink2));
            transition: .4s;
        }
        .question {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 28px;
        }
        .options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 18px;
        }
        .option {
            padding: 18px;
            border-radius: 22px;
            border: 1px solid var(--border);
            cursor: pointer;
            text-align: center;
            font-weight: 600;
            transition: background .3s, border-color .3s;
        }
        .option:hover {
            background: var(--pink-soft);
            border-color: var(--pink);
        }
        .next {
            margin-top: 28px;
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 22px;
            background: linear-gradient(135deg, var(--pink), var(--pink2));
            color: #fff;
            cursor: pointer;
            display: none;
            font-size: 16px;
            transition: background .3s;
        }
        .next:hover {
            background: var(--pink2);
        }
        .sheet {
            max-height: 620px;
            overflow: auto;
        }
        .sheet-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 14px;
        }
        .sheet-cell {
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 12px;
            display: grid;
            grid-template-columns: 32px 1fr;
            gap: 10px;
        }
        .sheet-cell.active {
            border-color: var(--pink);
            box-shadow: 0 0 0 3px var(--pink-soft);
        }
        .answers {
            display: flex;
            justify-content: space-between;
        }
        .bubble {
            width: 32px;
            height: 32px;
            border-radius: 999px;
            border: 2px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 13px;
        }
        .correct {
            background: var(--correct);
            color: #fff;
            border: none;
        }
        .wrong {
            background: var(--pink);
            color: #fff;
            border: none;
        }
        .result {
            text-align: center;
            margin-top: 40px;
        }
        .score {
            font-size: 48px;
            font-weight: 900;
            color: var(--pink);
        }
        .desc {
            margin-top: 10px;
            font-size: 20px;
            font-weight: 600;
        }
        .print {
            margin-top: 24px;
            padding: 14px 34px;
            border-radius: 999px;
            border: none;
            background: #111;
            color: #fff;
            cursor: pointer;
            font-size: 15px;
            transition: background .3s;
        }
        .print:hover {
            background: #333;
        }
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .table th, .table td {
            border: 1px solid var(--border);
            padding: 10px;
            text-align: center;
        }
        .table th {
            background: var(--pink);
            color: #fff;
        }
        .table td.correct {
            background: #7fd1b9;
        }
        .table td.wrong {
            background: #fa4779;
        }
        @media print {
            .theme-toggle, .next { display: none; }
            body { background: #fff; }
        }
        .quizly-logo{
  position: fixed;
  top: 16px;
  right: 18px;
  z-index: 999;
}

.quizly-logo img{
  width: 74px; /* ุงูุฏุงุฒู ููุทูุ ูู ุฑุฒ ูู ฺฏูุฏู */
  cursor: pointer;
  animation: quizlyFloat 4s ease-in-out infinite;
  filter: drop-shadow(0 10px 28px rgba(250,71,121,.55));
  transition: transform .35s ease, filter .35s ease;
}

.quizly-logo img:hover{
  transform: scale(1.12) rotate(3deg);
  filter: drop-shadow(0 16px 40px rgba(250,71,121,.85));
}

@keyframes quizlyFloat{
  0%   { transform: translateY(0); }
  50%  { transform: translateY(-6px); }
  100% { transform: translateY(0); }
}

    </style>
</head>
<body>
<div class="quizly-logo">
  <img src="https://uploadkon.ir/uploads/7e2d29_25Quizly.png" alt="Quizly Logo">
</div>

<button class="theme-toggle" onclick="toggleTheme()">๐</button>

<div class="wrapper">
    <div class="card">
        <div class="progress-wrap">
            <div class="progress" id="progress"></div>
        </div>
        <div id="quiz"></div>
        <button class="next" id="nextBtn" onclick="next()">ุจุนุฏ</button>
        <div class="result" id="result"></div>
    </div>
    <div class="sheet">
        <div class="sheet-grid" id="sheet"></div>
    </div>
</div>

<script>
const questions = [
  {q:"ฺฉุฏุงู ฺฏุฒูู ูุฌู ูุดุชุฑฺฉ ุจู ฺฉูู ูุธุฑูโูุง ุฑูุงูุฏุฑูุงู ูโุจุงุดุฏุ",options:["ุงุฌุงุฏ ุฑุงุจุทู ุนุงุทู ุจุง ุฏุฑูุงูุฌู","ุชุฃฺฉุฏ ุจุฑ ูุงุฎูุฏุขฺฏุงู","ุชูุฑฺฉุฒ ุจุฑ ุชุบุฑุงุช ุดูุงุฎุช ุฏุฑูุงูุฌู","ุชุฃฺฉุฏ ุจุฑ ุงุฏฺฏุฑ ุฑูุชุงุฑูุง ุฌุฏุฏ"],answer:0},
  {q:"ุจุฑ ุงุณุงุณ ูุธุฑู ูุฑูุฏ ุนูุช ุงุฌุงุฏ ุถุฑุจู ุฑูุงู ุดุฏุฏ ฺู ูโุจุงุดุฏุ",options:["ุณุฑฺฉูุจ ฺฉ ุงูฺฏุฒู ูุฑูููุฏ","ูุงุฒูุง ุฌูุณ","ฺฏุฑุงุดโูุง ููุงุฏ","ุญู ูุดุฏู ุนูุฏู ุงุฏูพ"],answer:0},
  {q:"ูุธุฑู ุฏุฑ ุฑูุงูุฏุฑูุงู ุจุฑ ฺฉุฏุงูฺฉ ุงุฒ ููุงุฑุฏ ุฒุฑ ุชุฃฺฉุฏ ุฏุงุฑุฏุ",options:["ุขุฒููู ูุฑุถู","ุทุฑุญ ูุฑุถู","ุขุณุจโุดูุงุณ ุฑูุงู","ุฌูุนโุขูุฑ ุงุทูุงุนุงุช"],answer:2},
  {q:"ฺูุฏ ุฏุฑุตุฏ ุงุฒ ูุชุงุฌ ูุซุจุช ุจุฏุณุช ุขูุฏู ุฏุฑ ูุดุงูุฑู ุจู ุนูุงูู ฺฉู ุฏุฑ ุงุฎุชุงุฑ ูุดุงูุฑ ูุณุช ุจุณุชฺฏ ุฏุงุฑุฏุ",options:["ฒฐ ุฏุฑุตุฏ","ณฐ ุฏุฑุตุฏ","ณต ุฏุฑุตุฏ","ฑต ุฏุฑุตุฏ"],answer:0},
  {q:"ุฑุงุฌโุชุฑู ูฺฉุงูุณู ุฏูุงุน ฺุณุชุ",options:["ุงุถุทุฑุงุจ","ุฏููโุชุฑุงุด","ุฌุจุฑุงู","ุณุฑฺฉูุจ"],answer:3},
  {q:"ฺฉุฏุงูฺฉ ุงุฒ ูฺฉุงูุณูโูุง ุฏูุงุน ุฒุฑ ูุคุซุฑ ู ุณุงุฒูุฏู ูุณุชูุฏุ",options:["ุฌุจุฑุงู","ููุงููุฏุณุงุฒ","ุชุตุนุฏ","ูุฑุงูฺฉู"],answer:2},
  {q:"ุชูุงูุช ุชุฑุณ ู ุงุถุทุฑุงุจ ุฏุฑ ฺุณุชุ",options:["ุชุฑุณ ููุจุน ุดูุงุฎุชู ุดุฏู ูู ุงุถุทุฑุงุจ ููุจุน ูุงุดูุงุฎุชู ุฏุงุฑุฏ","ุชุฑุณ ููุจุน ุดูุงุฎุชู ูุดุฏู ูู ุงุถุทุฑุงุจ ููุจุน ูุดุฎุต ุฏุงุฑุฏ","ุนูุช ุชุฑุณ ุนุฏู ุชุฎูู ุชฺฉุงููโูุง ุฌูุณ ุงุณุช","ุชุฑุณ ูุซุจุช ุงูุง ุงุถุทุฑุงุจ ุชุฃุซุฑ ููู ุฏุงุฑุฏ"],answer:0},
  {q:"ุฏุฑ ฺฉุฏุงูฺฉ ุงุฒ ุดุฑุงุท ุฒุฑ ูุจุฏู ุฏุฑ ฺฉ ูุฑุญูู ุฑุดุฏ ุจุงู ูโูุงูุฏุ",options:["ุชุตุนุฏ","ุชุนุงุฑุถ","ุงุถุทุฑุงุจ","ุชุซุจุช"],answer:3},
  {q:"ฺฉุฏุงู ุนุงูู ููุฌุจ ุงุฌุงุฏ ููุงููุช ูโุดูุฏุ",options:["ุณุงูุณูุฑ","ุชุนุงุฑุถ","ุงุถุทุฑุงุจ","ุจโุงุนุชูุงุฏ"],answer:0},
  {q:"ุฏุฑูุงู ุจู ูุฑุฏ ุฏุฑ ฺฉุฏุงู ุฏุณุชู ุงุฒ ุฏุฑูุงูโูุง ุฒุฑ ูุฑุงุฑ ูโฺฏุฑุฏุ",options:["ุฑูุงูฺฉุงู ฺฉูุงุณฺฉ","ุฑูุงูโุฏุฑูุงู ูพูุด ฺฉูุชุงูโูุฏุช","ุฑูุงูโุฏุฑูุงู ุชุญูู ุฑูุงู","ุฑูุงู ุชุญููโฺฏุฑ"],answer:1},
  {q:"ุฏุฑ ฺฉุฏุงูฺฉ ุงุฒ ฺฏุฑุงุดโูุง ุฒุฑ ููุฌูุฏ ุจู ุณูุช ูพฺุฏฺฏ ูโุฑูุฏุ",options:["ูุทุฑ","ุดฺฉููุง ุดุฏู","ุชฺฉูู","ุบุฑุฒ"],answer:2},
  {q:"ฺฉุฏุงูฺฉ ุงุฒ ฺฏุฒููโูุง ุฒุฑ ุจุฑุง ุฑุณุฏู ุจู ุงุฑุฒุดฺฏุฐุงุฑ ุงุฑฺฏุงูุณู ูุงุฒู ุงุณุชุ",options:["ุชูุฌู ูุซุจุช ูุงูุดุฑูุท","ูุฌูุฏ ุดุฑุงุท ุงุฑุฒุด","ฺฏุฑุงุด ุดฺฉููุง ุดุฏู","ุชูุฌู ูุซุจุช ูุงูุดุฑูุท"],answer:3},
  {q:"ุดฺฉุงู ุนูู ุจู ุฎูุฏ ุขุฑูุงู ู ุฎูุฏูพูุฏุงุฑู ุจุงูฺฏุฑ ฺู ฺุฒ ุงุณุชุ",options:["ููุฎูุงู","ุดุฎุตุช ูุงุณุงูู","ุชุนุงุฏู ุฑูุงู","ุขุณุจโูพุฐุฑ"],answer:1},
  {q:"ุงุฒ ูุธุฑ ุฑุงุฌุฑุฒ ูููุชุฑู ูฺฺฏ ูุฑุฏ ฺฉุงูู ฺู ูโุจุงุดุฏุ",options:["ุฏุงุดุชู ููุฎูุงู","ุงุฏุฑุงฺฉ ุจุงูุง","ุนุฒุช ููุณ ููุงุณุจ","ฺฏุฑุงุด ุดฺฉููุง"],answer:3},
  {q:"ุฏุฑฺฉ ุดุฑุงุท ุฏุฑูุงูุฌู ุจุฏูู ูุถุงูุช ฺฉุฑุฏู ฺฉุฏุงู ฺฏุฒูู ุฑุง ูุดุงู ูโุฏูุฏุ",options:["ููุฏุฑุฏ","ูพุฐุฑุด ูุดุฑูุท","ุฑุงุจุทู ุนุงุทู","ููุฏู"],answer:3},
  {q:"ุจู ฺู ุฏูู ุฑุงุฌุฑุฒ ุจู ุงูุฑุงุฏ ุณุงูู ุงุฒ ูุธุฑ ุฑูุงู ยซุงูุฑุงุฏ ุขูุฏูยป ูโฺฏูุฏุ",options:["ุจู ุฏูู ุงุฏุฑุงฺฉ ุฏุฑุณุช ุจุฑุง ุขูุฏู ุจุฑูุงููโุฑุฒ ุฏุงุฑูุฏ","ุจู ุฏูู ุณุงุฒฺฏุงุฑ ุดุงูุณ ุจุดุชุฑ ุจุฑุง ุฒูุฏู ูุงูุฏู ุฏุงุฑูุฏ","ุฒุฑุง ุฏุงุฑุง ุฎูุฏูพูุฏุงุฑู ููุงุณุจ ู ูุงูุนโุจูุงูู ูุณุชูุฏ","ุฒุฑุง ููุฎูุงู ู ููุงููฺฏ ูุณุชูุฏ"],answer:0},
  {q:"ูููุชุฑู ูฺฺฏโูุง ุงูุณุงู ุงุฒ ูุธุฑ ูุฑุงูฺฉู ฺุณุชุ",options:["ูุนูุงุฌูุ ุจโููุชุง ู ูพุดุชฺฉุงุฑ","ูุนูุงุฌูุ ูุณุฆููุชโูพุฐุฑ ู ุงูุฏูุงุฑ","ูุนูุงุฌูุ ูุณุฆููุชโูพุฐุฑ ู ุจโููุชุง","ูุนูุงุฌูุ ูุณุฆููุชโูพุฐุฑ ู ุชูุงูุง ุชุญูู ุฑูุฌ"],answer:3},
  {q:"ูุจูุง ุชุฆูุฑฺฉ ูุนู ุฏุฑูุงู ฺฉุฏุงูฺฉ ุงุฒ ูุธุฑูโูุง ุฒุฑ ูโุจุงุดุฏุ",options:["ุฑูุงูโุดูุงุณ ูุณุชโฺฏุฑุง","ุฑูุงูโุดูุงุณ ุดูุงุฎุชโฺฏุฑุง","ูพุฏุฏุงุฑุดูุงุฎุช","ุฑูุงูโุดูุงุณ ุงูุณุงูโฺฏุฑุง"],answer:0},
  {q:"ุฏุฑ ฺฉุฏุงูฺฉ ุงุฒ ูููู ุฒุฑ ุญููู ูุนูุจ ุฑูุงูโุฑูุฌูุฑ ุดฺฉุณุชู ูโุดูุฏุ",options:["ุจุงุฒุชุงุจโุฒุฏุง","ูุตุฏ ูุชูุงูุถ","ุชุนุฏู ูฺฏุฑุด","ุญุณุงุณุช ุจู ูุนูุง"],answer:1},
  {q:"ุงุฒ ูุธุฑ ูพุฑูุฒ ุณุทุญ ูุจุงู ุขฺฏุงู ุดุงูู ฺู ููุงุฑุฏ ูโุดูุฏุ",options:["ููุถูุนุงุช ุงูุฌุง ู ุงฺฉููู","ูฺฏุฑุงู ู ุชุฑุณโูุง","ฺฉูู ุดูุงุฎุชโูุง ู ุขฺฏุงูโูุง","ุชุนุตุจุงุช ู ูพุดโุฏุงูุฑโูุง"],answer:2},
  {q:"ฺฉุฏุงูฺฉ ุงุฒ ฺฏุฒููโูุง ุฒุฑ ุฌุฒุก ุนูุงูู ูุฒุงุญู ุจุฑุง ุดฺฉูโฺฏุฑ ฺฉ ฺฏุดุชุงูุช ฺฉุงูู ููโุจุงุดุฏุ",options:["ุงูุณุฏุงุฏ ูุงุฒูุง","ุชูุงุณ ุงุฏุฑุงฺฉ ุถุนู","ููุฎูุงู","ูุงุณโุฒู ุงุญุณุงุณุงุช"],answer:2},
  {q:"ุงุฒ ูุธุฑ ูพุฑูุฒ ุนูุช ุงุฌุงุฏ ุงุถุทุฑุงุจ ฺุณุชุ",options:["ุถุฑุจูโูุง ุฑูุงู","ูุจูุฏู ุฏุฑ ุฒูุงู ุญุงู","ุดฺฉุงู ูุงู ฺฏุฐุดุชู ู ุขูุฏู","ููู ููุงุฑุฏ"],answer:3},
  {q:"ุชูุฑฺฉุฒ ูุดุงูุฑู ูุนู ุฏุฑูุงู ุจุฑ ฺู ุฒูุงู ุงุณุชูุงุฑ ุงุณุชุ",options:["ุญุงู","ุขูุฏู","ฺฏุฐุดุชู","ฺฏุฐุดุชู ู ุขูุฏู"],answer:2},
  {q:"ุงุฒ ูุธุฑ ูพุฑูุฒ ฺฉุดูฺฉุด ุงุณุงุณ ุฏุฑ ุงูุณุงู ฺู ฺุฒ ูโุจุงุดุฏุ",options:["ุชุถุงุฏ ุจู ฺุฒ ฺฉู ูุณุชู ู ฺุฒ ฺฉู ุฏฺฏุฑุงู ูโุฎูุงููุฏ ุจุงุดู","ฺฉุดูฺฉุด ุจู ูุงุฒูุง ูุงุฏ ู ุฎูุฏุดฺฉููุง","ุชุถุงุฏ ุจู ุฎูุฏูพูุฏุงุฑู ู ุฎูุฏ ุขุฑูุงู ุฏุฑ ุงูุณุงู","ฺฉุดูฺฉุด ุจู ุชูุงูุงุช ูุฑุฏ ู ูุงุฒูุง ุงุฑฺฏุงูุณู"],answer:0},
  {q:"ุงุฒ ูุธุฑ ุฑูุงูโุดูุงุณุงู ุดูุงุฎุช ุนูุช ูุดฺฉูุงุช ุฑูุงูโุดูุงุฎุช ฺุณุชุ",options:["ุจุงูุฑูุง ูุดฺฉูโุฏุงุฑ ู ูุฏู","ุชูุณุฑูุง ุบูุท ู ุจุงูุฑูุง ุบุฑููุทู","ูุฏุงุดุชู ูุนู ู ูุฏู ุฏุฑ ุฒูุฏฺฏ","ุงุฏฺฏุฑโูุง ุบูุท ุฏุฑ ุทูู ุฒูุงู"],answer:1},
  {q:"ูููู ุฏุฑูุงู ุดูุงุฎุช ุฑูุชุงุฑ ฺู ูฺฺฏโูุง ุฏุงุฑูุฏุ",options:["ููุงุฑุชโูุง ุขููุฎุชู ูุณุชูุฏ","ุฑูุดโูุง ุฐูู ู ูฺฉุฑ ูุณุชูุฏ","ุฑูุดโูุง ุฑูุชุงุฑ ู ฺฏุฐุดุชูโูฺฏุฑ ูุณุชูุฏ","ูุงุฒ ุจู ุชุฎุตุต ุจุงูุง ุฏุงุฑูุฏ"],answer:0},
  {q:"ุงุฒ ูุธุฑ ุขูุจุฑุช ุงูุณ ุชูุงู ุงูุณุงู ุจู ุชูฺฉุฑ ุบุฑููุทู ฺู ูุจูุง ุฏุงุฑุฏุ",options:["ุดูุงุฎุช","ุบุฑุฒ","ุฒุณุช","ููุณู"],answer:2},
  {q:"ุฏุฑ ุงูุชุฒุงุน ุงูุชุฎุงุจ ฺู ุญุงูุช ุฑู ูโุฏูุฏุ",options:["ุจุด ุจุฑุขูุฑุฏ ฺฉุฑุฏู ุฌูุจูโูุง ููู ฺฉ ูููุนุช ู ฺฉู ุจุฑุขูุฑุฏ ฺฉุฑุฏู ุฌูุจูโูุง ูุซุจุช ุขู","ูุชุฌูโฺฏุฑ ฺฉู ุงุฒ ฺฉ ูููุนุช ู ุชุนูู ุขู ุจู ุณุงุฑ ููุงุฑุฏ ูุดุงุจู ุง ุบุฑูุดุงุจู","ูุชุฌูโฺฏุฑ ููู ุงุฒ ฺฉ ุฑูุฏุงุฏ ุจุฏูู ูุฌูุฏ ุดูุงูุฏ ฺฉุงู ุจุฑุง ุขู","ุชุฃฺฉุฏ ุจุดุชุฑ ุจุฑ ุฑู ุฌุฒุก ููู ฺฉ ูููุนุช ู ูุงุฏุฏู ฺฏุฑูุชู ุฌูุจูโูุง ูุซุจุช ุขู"],answer:3},
  {q:"ุฏุฑ ฺฉุฏุงูฺฉ ุงุฒ ุดุฑุงุท ุฒุฑ ูุญุฑูุงูู ุจูุฏู ุฌูุณู ูุดุงูุฑู ููุถ ูโุดูุฏุ",options:["ููุถูุน ุจู ุงุฎุชูุงูุงุช ููู ูุฑุจูุท ุดูุฏ","ุงุญุชูุงู ุทูุงู ูุทุฑุญ ุดูุฏ","ููุถูุน ุญุงุฏ ู ุดุฏุฏ ุจุงุดุฏ","ูุฑุงุฌุน ูุงุฒ ุจู ุจุณุชุฑ ุดุฏู ุฏุงุดุชู ุจุงุดุฏ"],answer:3},
  {q:"ฺฏุฒูู ููุงุณุจ ุฑุง ุจุฑ ุงุณุงุณ ูุธุฑู ูุฑูุฏ ุงูุชุฎุงุจ ููุงุฆุฏ:",options:["ูุงูุดุงุฑ ุนููโุชุฑู ู ูุณุนโุชุฑู ุจุฎุด ุดุฎุตุช ูโุจุงุดุฏ","ูููโูุดุงุฑ ูุญู ุงุณุชูุฑุงุฑ ูฺฉุงูุณูโูุง ุฏูุงุน ุงุณุช","ูุดุงุฑ ุนููโุชุฑู ู ูุณุนโุชุฑู ุจุฎุด ุดุฎุตุช ุงุณุช","ูฺฉุงูุณูโูุง ุฏูุงุน ุฏุฑ ููู ุณุทูุญ ุดุฎุตุช ุญุถูุฑ ุฏุงุฑูุฏ"],answer:0}
];

    let index = 0;
    let correctCount = 0;
    const userAnswers = Array(questions.length).fill(null);

    const quiz = document.getElementById("quiz");
    const sheet = document.getElementById("sheet");
    const nextBtn = document.getElementById("nextBtn");
    const progress = document.getElementById("progress");

    function render() {
        const q = questions[index];
        quiz.innerHTML = `
            <div class="question">${q.q}</div>
            <div class="options">
                ${q.options.map((o, i) => `<div class="option" onclick="select(${i})">${o}</div>`).join("")}
            </div>`;
        nextBtn.style.display = "none";
        updateProgress();
        renderSheet();
    }

    function updateProgress() {
        progress.style.width = `${(index / questions.length) * 100}%`;
    }

    function renderSheet() {
        sheet.innerHTML = questions.map((q, i) => {
            const ua = userAnswers[i];
            return `
                <div class="sheet-cell ${i === index ? "active" : ""}">
                    <b>${i + 1}</b>
                    <div class="answers">
                        ${["ุงูู", "ุจ", "ุฌ", "ุฏ"].map((l, j) => {
                            let c = "";
                            if (ua !== null) {
                                c = j === q.answer ? "correct" : (j === ua ? "wrong" : "");
                            }
                            return `<div class="bubble ${c}">${l}</div>`;
                        }).join("")}
                    </div>
                </div>`;
        }).join("");
    }

    function select(i) {
        if (userAnswers[index] !== null) return;
        userAnswers[index] = i;
        if (i === questions[index].answer) correctCount++;
        nextBtn.style.display = "block";
        renderSheet();
    }

    function next() {
        index++;
        if (index < questions.length) {
            render();
        } else {
            finish();
        }
    }

    function finish() {
        progress.style.width = "100%";
        const totalQuestions = questions.length;
        const grade = ((correctCount / totalQuestions) * 20).toFixed(2);
        const percentage = ((correctCount / totalQuestions) * 100).toFixed(2);
        const answeredQuestions = userAnswers.filter(answer => answer !== null).length;
        let desc = "";

        if (grade >= 18) desc = "ุนุงู ู ูุณูุท";
        else if (grade >= 15) desc = "ุฎูุจ";
        else if (grade >= 12) desc = "ูุงุจู ูุจูู";
        else desc = "ูุงุฒููุฏ ุชูุฑู ุฌุฏ";

        quiz.innerHTML = `
            <div class="score">${grade} / ฒฐ</div>
            <div class="desc">${desc}</div>
            <div>ุดูุง ${answeredQuestions} ุงุฒ ${totalQuestions} ุณูุงู ุฑุง ูพุงุณุฎ ุฏุงุฏูโุงุฏ. (${percentage}%)</div>
            <button class="print" onclick="openPrintWindow()">ุขูุงุฏูโุณุงุฒ ุฌูุช ฺุงูพ</button>
        `;
    }

    function openPrintWindow() {
        const printWindow = window.open('', '_blank');
        printWindow.document.write(`
            <html lang="fa" dir="rtl">
            <head>
                <meta charset="UTF-8">
                <title>ูุชุฌู ุขุฒููู</title>
                <style>
                    body { font-family: 'Vazirmatn', Tahoma, sans-serif; direction: rtl; }
                    .result { text-align: center; margin: 20px; }
                    .table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                    .table th, .table td { border: 1px solid #ddd; padding: 10px; text-align: center; }
                    .table th { background: var(--pink); color: #fff; }
                    .table td.correct { background: #7fd1b9; }
                    .table td.wrong { background: #fa4779; }
                </style>
            </head>
            <body>
                <div class="result">
                    <h1>ูุชุฌู ุขุฒููู</h1>
                    <div class="score">${(correctCount / questions.length * 20).toFixed(2)} / ฒฐ</div>
                    <div>ุดูุง ${userAnswers.filter(answer => answer !== null).length} ุงุฒ ${questions.length} ุณูุงู ุฑุง ูพุงุณุฎ ุฏุงุฏูโุงุฏ.</div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ุณูุงู</th>
                                <th>ูพุงุณุฎ ุดูุง</th>
                                <th>ูพุงุณุฎ ุตุญุญ</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${questions.map((q, i) => `
                                <tr>
                                    <td>${q.q}</td>
                                    <td class="${userAnswers[i] === q.answer ? 'correct' : 'wrong'}">${["ุงูู", "ุจ", "ุฌ", "ุฏ"][userAnswers[i]] || 'ูพุงุณุฎ ุฏุงุฏู ูุดุฏู'}</td>
                                    <td>${["ุงูู", "ุจ", "ุฌ", "ุฏ"][q.answer]}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            </body>
            </html>
        `);
        printWindow.document.close();
        printWindow.focus();
        printWindow.print();
        printWindow.close();
    }

    function toggleTheme() {
        document.body.classList.toggle("dark");
    }

    render();
</script>

</body>
</html>
